アプリ機能要件
• カレンダー機能

• ホームメニュー（今日の処方箋）

• タイムラインで認知行動療法に基づいたタスクを処方箋として自動表示

• 不安障害、パニック障害、不眠症の3つのモード

• 各モードに適した画面
• 不安日記

• ジャーナリング

• 4-7-8呼吸法
• 不安日記

• ジャーナリング

• 4-7-8呼吸法
• メニューバーをタブに固定表示（ホーム、カレンダー、設定、呼吸）

• モードの切り替えは設定から行う
• 各モード切り替え時や初回設定時に、CBTの役割や症状改善に繋がる行動を説明するスライドを少ない枚数で表示し、スワイプで開始できるようにする
• ホーム画面に「今の体調」「今の気分」項目を設置し、顔文字5段階でタップするだけで時間と顔文字を記録

• カレンダーで日付をタップすると詳細画面が表示され、気分の記録が時系列で確認可能

• カレンダービューでは、気分のスコア（1点から5点）の平均点の顔文字を表示
• ジャーナリングはチャット形式の質問応答で記録し、カレンダーから確認できるようにする
• 睡眠ログデータに基づき、理想的な睡眠時間や就寝時刻を算出し表示

• 理想的な睡眠時間に向けて行うべきタスクを不眠症モードなどに表示

3つのモード（Deep Sleep, Quiet Mind, Anchor）は、単に表示名が違うだけでなく、**「ホーム画面のレイアウト」「優先的に表示する機能」「通知のタイミング」**を根本的に変えることで、ユーザー体験（UX）を最適化します。
開発時にそのまま使えるよう、各モードの仕様と実装ロジックを定義しました。

🛠 モード別実装仕様書
1. 🌙 Deep Sleep Mode (不眠改善特化)
ターゲット: 「眠気がないのにベッドに入ってしまう」「生活リズムが崩れている」ユーザー。
CBT-Iの中核: 睡眠制限法 (Sleep Restriction) と 刺激制御法。
ホーム画面 UI (Layout Priority):
最上部 (Hero): 「処方された睡眠スケジュール」のカウントダウン。
表示例: "Next Bedtime: 23:30" (あと2時間15分です。まだ起きていてください)
メインアクション: 「睡眠日誌をつける」ボタン（未入力時のみ強調）。
サブ機能: 睡眠衛生のTips（カフェインを控える時間など）。
ロジック・挙動:
就寝ロック: 指定時間（例: 23:30）になるまで、アプリは「ベッドに入る」ことを推奨しない。
通知:
就寝1時間前: "Wind-down time"（スマホを置いてリラックスしましょう）
就寝時刻: "Sleep window open"（ベッドに入ってOKです）
起床時刻: "Time to wake up"（アラームと連動）

**
* （このモードでは、上記のような「ベッドにいる時間を制限して睡眠効率を高める」グラフを進捗画面で見せ、モチベーションを維持させます）
2. 🛡️ Quiet Mind Mode (思考整理・不安対策)
ターゲット: 「ベッドに入ると考え事が止まらない」「明日のことが不安」なユーザー。
CBT-Iの中核: 悩み時間 (Worry Time) と ジャーナリング。
ホーム画面 UI (Layout Priority):
最上部 (Hero): 「Brain Dump（脳のゴミ捨て）」ボタン。
表示例: "What's on your mind?" (タップするとすぐに書き込める入力欄が開く)
メインアクション: 「今日のWorry Timeを予約する」または「Worry Timeを開始する」。
サブ機能: 明日のToDoリスト作成（夜の不安を減らすため）。
ロジック・挙動:
夜間の思考停止: 夜（例: 22時以降）に思考を書き出すと、自動的に「明日考えること」リストに移動させ、「今は考えなくていい」というメッセージを表示する（思考停止法）。
通知:
夕方: "Scheduled Worry Time"（悩む時間です。思い切り悩みましょう）
3. ⚓️ Anchor Mode (パニック・身体的緊張ケア)
ターゲット: 「動悸がする」「呼吸が浅い」「眠れるかどうかが怖い（予期不安）」ユーザー。
CBT-Iの中核: リラクゼーション (Relaxation) と 身体感覚への介入。
ホーム画面 UI (Layout Priority):
最上部 (Hero): 巨大な 「SOS / Grounding」 ボタン。
デザイン: 画面中央に配置し、タップしやすいデザイン。
メインアクション: 5分間の「筋弛緩法」や「呼吸ガイド」へのショートカット。
サブ機能: 今の気分（不安レベル）のスライダー記録。
ロジック・挙動:
即時性: アプリ起動から1タップ以内で必ず「呼吸ガイド」が始まる設計にする。
オーディオ優先: 文字を読むのが辛い状態を想定し、音声ガイダンスを主体にする。

💻 開発用データ構造 (TypeScript / Config)
Cursorエディターで実装する際、if文で分岐させるとコードが汚くなるため、「設定オブジェクト（Config）」 パターンで管理することを推奨します。
以下のコードを指示書としてCursorに渡してください。
TypeScript
// src/constants/Modes.ts

export type AppModeID = 'DEEP_SLEEP' | 'QUIET_MIND' | 'ANCHOR';

interface ModeConfig {
  id: AppModeID;
  displayName: string;
  themeColor: string; // アクセントカラーを変える
  
  // ホーム画面の構成要素（表示順序）
  homeComponents: ('SLEEP_WINDOW' | 'WORRY_INPUT' | 'SOS_BUTTON' | 'SLEEP_LOG')[];
  
  // 主要なCTA（Call To Action）ボタンのラベル
  primaryActionLabel: string;
  
  // オンボーディング完了時のメッセージ
  welcomeMessage: string;
}

export const MODES: Record<AppModeID, ModeConfig> = {
  DEEP_SLEEP: {
    id: 'DEEP_SLEEP',
    displayName: 'Deep Sleep Plan',
    themeColor: '#5E81AC', // Nord Blue
    homeComponents: ['SLEEP_WINDOW', 'SLEEP_LOG', 'SOS_BUTTON'],
    primaryActionLabel: 'Check Schedule',
    welcomeMessage: 'Let’s build your sleep drive.',
  },
  QUIET_MIND: {
    id: 'QUIET_MIND',
    displayName: 'Quiet Mind Plan',
    themeColor: '#88C0D0', // Lighter Blue
    homeComponents: ['WORRY_INPUT', 'SLEEP_LOG', 'SOS_BUTTON'],
    primaryActionLabel: 'Clear Your Mind',
    welcomeMessage: 'Leave your worries here.',
  },
  ANCHOR: {
    id: 'ANCHOR',
    displayName: 'Anchor Plan',
    themeColor: '#BF616A', // Muted Red (Calming)
    homeComponents: ['SOS_BUTTON', 'SLEEP_LOG', 'SLEEP_WINDOW'],
    primaryActionLabel: 'Breathe Now',
    welcomeMessage: 'You are safe here.',
  },
};

🧩 実装のポイント
コンポーネントの共通化:
SleepWindowCard, WorryInputCard, SosButton などのコンポーネントは個別に作っておきます。
Home画面のレンダリング:
Home画面のコードでは、currentMode.homeComponents.map(...) を使って、設定された順序通りにコンポーネントを描画します。
これにより、モードごとの画面を個別に作る必要がなくなり、メンテナンスが楽になります。
🚀 Cursorへの指示例
Cursorへの指示:
src/constants/Modes.ts を作成し、上記の設定オブジェクトを定義してください。
その後、HomeScreen.tsx を修正し、Zustandストアで保持している userMode に基づいて、homeComponents 配列の順序通りにUIコンポーネントをレンダリングするように書き換えてください。
これにより、モードによってホーム画面の見た目と優先機能が切り替わるようにしてください。
このように実装すれば、将来「新しいモード」を追加したくなった時も、Configに追加するだけで済みます。
